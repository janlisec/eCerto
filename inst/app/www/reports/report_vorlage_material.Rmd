---
title: "&nbsp;"
title-meta: Material-Report
params:
  materialtabelle: NA
  General: NA
  logo_file: NA
output:
  word_document: 
    reference_docx: template.docx
  html_document:
    df_print: paged
  pdf_document:
    latex_engine: lualatex
fontsize: 11pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
testing <- length(params$General)==1L && (is.na(params$General) | params$General=="NA")
if (testing) {
  report_file <- "report_vorlage_material.Rmd"
  logo_file <- "BAMLogo2015.png"
  fnc_get_local_file <- function(x=NULL) {
    pkg_path <- system.file(package = "eCerto")
    file_path <- list.files(path=pkg_path, pattern = x, recursive = TRUE)[1]
    return(file.path(pkg_path, file_path, fsep="/"))
  }
  res <- eCerto::CRM001
  M <- res$General$materialtabelle
  G <- res$General
  A <- paste(names(G[["apm"]]), collapse=", ")
  if (!file.exists(file.path(dirname(fnc_get_local_file(x=report_file)), logo_file))) {
    warning(paste(logo_file, "is not in same folder as", report_file))
  }
  L <- logo_file
} else {
  M <- params[["materialtabelle"]]
  G <- params[["General"]]
  A <- paste(names(G[["apm"]]), collapse=", ")
  L <- params[["logo_file"]]
}
```

***Note!*** 
This is a Report template for demonstration purpose. Specific layouts can be generated on demand.

---

```{r Logo, echo=FALSE, out.width="20%", fig.align="right"}
  knitr::include_graphics(L)
```

### Meta Data

|               |                |               |                                     |
|--------------:|:---------------|--------------:|:------------------------------------|
| **Study ID:** | `r G$study_id` |    **Date:**  | `r format(Sys.time(), '%d %B, %Y')` |
|     **User:** | `r G$user`     | **Analytes:** | `r A`                               |


### Material table

```{r mat_tab, echo=FALSE}
  df <- M
  if (knitr::is_html_output()) {
    kableExtra::kable_styling(knitr::kable(df, format="html", row.names=FALSE, format.args = list(decimal.mark = ".")), font_size = 9)
  } else if (knitr::is_latex_output()) {
    knitr::kable(df, row.names=FALSE, format="latex", format.args = list(decimal.mark = "."))
  } else {
    knitr::kable(df, row.names=FALSE, format="pipe", format.args = list(decimal.mark = "."))
  }
```

